# 1. 使用

- 【目的】为了解决团队成员因为自己电脑计算机环境的遭、乱；解决成员不愿意背着厚重的笔记本来到这；解决成员开发环境工具的不统一问题；解决成员之间文件互传过慢的问题—— STA 共享计算机皆为解决。

- 【信息】

```bash
我的电脑	英特尔 X99 台式电脑

操作系统	Windows 10 Pro for Workstations 64位

主显卡	独立显卡(对游戏和电影支持较好)

IE浏览器	版本号  11.0


基本硬件展示

处理器	英特尔 Xeon(至强) E5-2666 v3 @ 2.90GHz (X2)

主板	英特尔 X99

内存	32 GB ( 镁光 DDR4 2133MHz 16GB x 2 )

主硬盘	 CHUXIA SSD-M9 256GB (256 GB / 固态硬盘)

主显卡	AMD Radeon RX 580 2048SP ( 8 GB / AMD )

显示器	戴尔 DELF129 DELL E2421HN ( 23.8 英寸  )

网卡	英特尔 Dual Band Wireless-AC 8265

声卡	瑞昱 High Definition Audio
```


## 1.1. 成员

1. 请求负责人为你开启账户

2. 登录你的用户（默认密码：12345678）

3. 负责人为你手动执行 2.1. 新增用户章节或者运行 `STA 共享计算机-新增成员.bat` 脚本

4. 阅读下方的共享计算机使用规矩

- 【桌面管理要求】桌面不能超过十个文件夹，若超过视为你文件管理不合格，应用图标请添加到开始菜单中！

- 【软件安装要求】安装软件请安装到 D 盘自己用户名字的目录下，建议按照目录说明所示的那样去安装到对应文件夹中，这样不会乱。

```bash
DailyApps：存放日常应用的文件夹
Driver：一些驱动安装文件夹
Environment：一些环境文件夹，比如 Python 之类的，样例可以参考 STA LAB 目录下的 Environment 样例。
ProfessionalAPPS：存放专业工具的文件夹
SysToolAPPS：存放系统工具的文件夹
TempFile：临时存放文件的目录，存放临时解压的文件或者是图片用
User：存放转移用户目录的下"视频"、"图片"、"文档"等的文件夹
```

```bash
Coding：存放和代码有关的个人应用，如 Vscode
Design：存放和设计有关的工具，如 Pixso
Electric：存放和电有关的工具，如 Multisim
Mechanics：存放和机械有关的的工具，如Solidworks
MultiMedia：存放和媒体有关的工具，如 Ps
Research：存放和研究有关的工具，如 ANSYS
```

- 【开始菜单要求】固定快捷方式到全屏任务菜单中只能够把磁贴往“个人组类”里面去添加，其他地方的排列不允许更改，保持全队开始菜单的统一，一切以管理用户的开始菜单为基准。

![Pasted image 20250628185723.png](https://i0.hdslb.com/bfs/openplatform/45fee76e42c8f0416e347832bb5fa2fe1f8752d0.png)


- 【环境管理要求】若发现你按照的软件环境是目前管理员账户没有的，你可以先安装到 D 盘自己名字文件夹下的的 Environment 目录中，不允许安装到 STA LAB 以及 STA_LAB 文件夹中，且发现共享计算机上没有的安装环境需要告知共享计算机的管理者。

4. 正式基于你的账户使用共享电脑



## 1.2. 管理员

1. 在每周对计算机进行备份一次，备份参考章节 2.5.1. 


2. 将成员反馈的没有的软件和一些其他环境类的记录，在每周末时登录管理员账户统一安装配置。然后按照 2.3. 章节重新备份一次

# 2. 维护

## 2.1. 新增成员

>**引言**：当有新成员来到时，请为其分配一个共享计算机账户，并且完成成员使用前的准备。

### 2.1.1. 新建用户账户



### 2.1.2. 登录该新建账户





### 2.1.3. 调整桌面设置

#### （1）显示此电脑

1. 首先，我们可以看到桌面上面没有我的电脑[^1]。

    ![win10如何显示我的电脑在桌面](https://exp-picture.cdn.bcebos.com/c3c22dbf3bef354f01d89e8a23db574afb321bf4.jpg?x-bce-process=image%2Fresize%2Cm_lfit%2Cw_500%2Climit_1%2Fformat%2Cf_auto%2Fquality%2Cq_80)

2. 我们在桌面空白处点击右键，选择“个性化”。
	
    ![win10如何显示我的电脑在桌面](https://exp-picture.cdn.bcebos.com/a99a494afa32939c7b97f5065719ce2c5a1b15f4.jpg?x-bce-process=image%2Fresize%2Cm_lfit%2Cw_500%2Climit_1%2Fformat%2Cf_auto%2Fquality%2Cq_80)

3. 然后我们可以看到左侧有一个“主题”，这里我们选择。

    ![win10如何显示我的电脑在桌面](https://exp-picture.cdn.bcebos.com/dd58d02c5b1b1edea9bc8a8d981fceecd2d90ff4.jpg?x-bce-process=image%2Fresize%2Cm_lfit%2Cw_500%2Climit_1%2Fformat%2Cf_auto%2Fquality%2Cq_80)

4. 我们找到相关设置，然后选择“桌面图标设置”，如图示。

    ![win10如何显示我的电脑在桌面](https://exp-picture.cdn.bcebos.com/f59dbe39131fceecb2b943c179c4ec9958430bf4.jpg?x-bce-process=image%2Fresize%2Cm_lfit%2Cw_500%2Climit_1%2Fformat%2Cf_auto%2Fquality%2Cq_80)

5. 在如图示位置，将“计算机”勾选，然后点击“应用”--"确定"。

    ![win10如何显示我的电脑在桌面](https://exp-picture.cdn.bcebos.com/a44e8afc508c9bce37a7a0c3d6dd884ce44afaf7.jpg?x-bce-process=image%2Fresize%2Cm_lfit%2Cw_500%2Climit_1%2Fformat%2Cf_auto%2Fquality%2Cq_80)

6. 我们回到桌面上面，我们可以看到“这台电脑”，已经在桌面上显示出来了，这里不是快捷方式。

    ![win10如何显示我的电脑在桌面](https://exp-picture.cdn.bcebos.com/cfadcdd96975f2c488f973f78f0148fe1f4206f4.jpg?x-bce-process=image%2Fresize%2Cm_lfit%2Cw_500%2Climit_1%2Fformat%2Cf_auto%2Fquality%2Cq_80)

#### （2）调整任务栏

- # 1. 调整搜索框为图标

1. 首先，在任务栏上单击鼠标右键，点击右键菜单中的“搜索”，
	
    ![Win10如何将搜索框显示成搜索图标？](https://exp-picture.cdn.bcebos.com/f591ab03c8d246fefac77b35b8bf3bef344f1e20.jpg?x-bce-process=image%2Fresize%2Cm_lfit%2Cw_500%2Climit_1%2Fformat%2Cf_auto%2Fquality%2Cq_80)

2. 点击“搜索”之后，会看到目前被勾选的是“显示搜索框”，接着点击勾选“显示搜索图标”，
	
    ![Win10如何将搜索框显示成搜索图标？](https://exp-picture.cdn.bcebos.com/b442d6d246fe474e7c0a8a09b0ef354f51b81f20.jpg?x-bce-process=image%2Fresize%2Cm_lfit%2Cw_500%2Climit_1%2Fformat%2Cf_auto%2Fquality%2Cq_80)

3. 最后会发现一长条的搜索框变成了一个小小的搜索图标，相比之下，是不是就小很多了呢？
	
    ![Win10如何将搜索框显示成搜索图标？](https://exp-picture.cdn.bcebos.com/c99358fe474ec2838c368259be4f50b8b53e1c20.jpg?x-bce-process=image%2Fresize%2Cm_lfit%2Cw_500%2Climit_1%2Fformat%2Cf_auto%2Fquality%2Cq_80)


- # 2. 关闭“资讯和兴趣”

1. 直接在任务栏右键弹出菜单，选择“资讯和兴趣”，二级菜单中选择“关闭”即可。如下图：

  ![](https://i-blog.csdnimg.cn/blog_migrate/5bae165c28b14f6a749d4e15974065ca.jpeg)

2. 在底端任务栏右键即可看到该菜单，把光标

    ![](https://i-blog.csdnimg.cn/blog_migrate/1a1f4a9a0ac3583177987598ed6bf32c.jpeg)

但这样的做法，只是不让“资讯和兴趣”的标签在任务栏显示，后台进程还是在运行中的，如果想要彻底禁用这项功能，还是需要通过注册表操作完成相关设置。

#### （3）调整锁屏界面

### 2.1.4. 在 D 盘中拷贝成员用户文件夹模板

1. 在D盘建立一个以自己用户名为名字的空文件夹（注意大小写和空格，这步建错了就完蛋了）

![Pasted image 20250628164644.png](https://i0.hdslb.com/bfs/openplatform/5f8b13a40ebac602b03604c295783654b6c06b07.png)

2. 复制 `E:\维护相关\成员用户文件夹模板` 下的所有子文件

![](https://i0.hdslb.com/bfs/openplatform/f8d5875ab6649de0324f931fc184919063f25527.png)

3. 拷贝到 `E:\维护相关\%username%` 文件夹中(把这个地址直接粘贴到地址栏就行)

![](https://i0.hdslb.com/bfs/openplatform/42c5a72237d5cd9c4f9d278450205f62b215607e.png)

### 2.1.5. 拷贝 C 盘中用户文件下到 D 盘

  1. win+r 输入 `C:\Users\%username%` 后回车，将如下所示的文件夹（除 `AppData` ）全部复制

![](https://i0.hdslb.com/bfs/openplatform/35cb138d9e7bf9c6cde9db48296bda1d3916d952.png)

<center><b>图：回车后的资源管理器</b></center>

2. win+r 输入 `E:\%username%\User` 后回车，将前面复制的文件拷贝到当前文件夹

![](https://i0.hdslb.com/bfs/openplatform/77c31d71dd09f6acb61a8dff946f95413f83f8ca.png)

### 2.1.6. 还原用户开始菜单

#### （1）替换开始菜单文件夹

1. 打开此电脑，点击如下如图所示的查看后，点击文件扩展名、隐藏的项目两项

![](https://i0.hdslb.com/bfs/openplatform/14c1023608bdd056f2b2d11f8a64fb100104955b.png)

2. 把 `E:\维护相关\部长桌面配置\Start Menu\` 下的内容复制到`C:\Users\%username%\AppData\Roaming\Microsoft\Windows\Start Menu` 中

>**提示**：可以用 Win+R 然后把文件地址粘贴到输入框回车快速打开文件夹



<center>图：复制前的目标文件夹</center>


![](https://i0.hdslb.com/bfs/openplatform/96e169b8e360bce113fafe0aa11ef1b15a075d65.png)

<center>图：复制后的目标文件夹</center>


#### （2）替换注册表及配置文件

1. 双击 `E:\维护相关\部长桌面配置\开始菜单注册表备份.reg` ，在弹出窗口点击是

![](https://i0.hdslb.com/bfs/openplatform/42ae6fc3431afc235623b6c157fd1c59783037ec.png)

![](https://pica.zhimg.com/v2-41c84e50c4d5fa5e70196fdc7475bc06_1440w.jpg)

>**提示**：可以用 Win+R 然后把文件地址粘贴到输入框回车以实现快速添加注册表

2. 按下 win+r 输入 `%LocalAppData%\Microsoft\Windows\Shell` 后回车

![](https://i0.hdslb.com/bfs/openplatform/8f159c3d2696885f04fc42820b207d2046f7693c.png)

<center><b>图：按下回车后的资源管理器</b></center>

3. 将 `E:\维护相关\部长桌面配置`  的 `DefaultLayouts.xml` 复制到到步骤2的文件夹，确认替换  

![](https://i0.hdslb.com/bfs/openplatform/42ae6fc3431afc235623b6c157fd1c59783037ec.png)

![](https://pic2.zhimg.com/v2-40abaecea853cfc66ba682942d8fd381_1440w.jpg)

4. 注销用户后重新登入用户，发现桌面文件就被拷贝过来了

![](https://i0.hdslb.com/bfs/openplatform/318f337c1bf55d252a07cf404a70a19308be51db.png)

<center><b>图：注销后按下 Win 键的开始菜单</b></center>

### 2.1.7. 还原浏览器配置

1. 右键任务栏，打开任务管理器，结束名为 `Edge` 的所有项目选项

![](https://i0.hdslb.com/bfs/openplatform/852dfefb1458a87385365fa11f9d410d84532e88.png)

2. 将 `E:\维护相关\部长桌面配置` 的 User Data 拷贝到 `C:\Users\%username%\AppData\Local\Microsoft\Edge` 下完成覆盖

![](https://i0.hdslb.com/bfs/openplatform/58c1d96d247d50993ff4d62e032479a8c9c3d3da.png)

3. 然后到设置中更改浏览器的下载目录为该用户本身的目录



### 2.1.8. 更改重要文件映射


#### （1）转移用户目录特殊文件夹

1. 拷贝 `C:\Users\%username%` 除了AppData 以外的文件夹（用 Ctrl + X）

![](https://i0.hdslb.com/bfs/openplatform/cd6e8de94ad6635f373703537353185fcdceb5c2.png)

2. 在 D 盘创建一个用户名为自己名字的目录

![](https://i0.hdslb.com/bfs/openplatform/bac33ff464e690f2f9c908869e384249e4b159ad.png)

3. 把刚刚复制的内容到这个目录（用 Ctrl + V）

![](https://i0.hdslb.com/bfs/openplatform/c8cbfe44d8e957edba841d4eb77d34c0020ab840.png)

这样数据就默认不会往你的 C 盘中存了

#### （2）使用软连接完成重要文件映射

1. 先在 D 盘创建实际所存放的目录

```bash

```

2. 再在 C 盘下进行相应的映射

```bash
# 映射 IJ 全家桶目录
mklink /j "C:\Users\%username%\IdeaProjects" "E:\%username%\User\IdeaProjects"
# 映射 Vscode 插件文件夹
mklink /j "C:\Users\%username%\.vscode" "E:\%username%\User\.vscode"
# 映射 Arduino 文件夹
mklink /j "C:\Users\%username%\.arduinoIDE" "E:\%username%\User\.arduinoIDE"
# 映射
mklink /j "C:\Users\%username%\.m2" "E:\%username%\User\.m2"

```

>**注意**：这一步能够进行的关键是在于 `在 D 盘中拷贝成员用户文件夹模板` 这一步创建的文件名是正确的。


#### （2）映射 SMB 局域网网盘

1. 按 Win+R 输入 `\\192.168.31.193`

![](https://i0.hdslb.com/bfs/openplatform/b4798ed2ff4d49a0828e2697b47a6721c97e6a4e.png)

2. 输入用户名 `esjian` ，密码 `wsrr`，按下回车




3. 右键 hhd 在下拉菜单中选择映射网络驱动器




4. 右键 hhd2 在下拉菜单中选择映射网络驱动器



## 2.2. 删除成员




## 2.3. 管理员备份

### 2.3.1. 登录管理员

### 2.3.1. 开始菜单备份

#### （1）备份注册表
1. 拷贝管理员桌面文件夹：`C:\Users\STA ADMIN\AppData\Roaming\Microsoft\Windows\Start Menu` 到 `E:\维护相关\部长桌面配置` 中

![Pasted image 20250610163601.png](https://i0.hdslb.com/bfs/openplatform/f728d26fa406df483772686bc1fb27e289a81dce.png)



> > **提示**：这一步有历史遗留问题，系统安装时候设置的是 STA ADMIN 用户名，但是后面发现创建名字有空字符，换成了 STA_LAB 但是系统在输入`C:\Users\%username%\AppData\Roaming\Microsoft\Windows\Start Menu` 时候访问的依然是 STA_ADMIN 这个用户的用户配置文件，所以之后在创建系统用户名字时切记不要带空格，创建时启用管理员账户。



2. Win+r 输入 regedit 打开注册表 

![image.png](https://i0.hdslb.com/bfs/openplatform/5301f8ace8f51aaecdd3fd3bb5bc8554dd30c28d.png)

3. 复制下面路径 `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\CloudStore\Store\Cache\DefaultAccount` 并且回车

![image.png](https://i0.hdslb.com/bfs/openplatform/290fd85b633ce27577bdfaf2f0d3ab7873bac6dc.png)


3. 选中defaultaccount 选择菜单栏 - 文件 - 导出

![](https://pic1.zhimg.com/v2-d7374a62471faf3867825cdc31c24c0c_1440w.jpg)

4. 选中你要保存备份的文件夹，输入文件名 `开始菜单注册表备份` ，然后保存到 `E:\维护相关\部长桌面配置` 中

![](https://pic1.zhimg.com/v2-a38b1989bb22d748e6ce3c67154b2584_1440w.jpg)

#### （2）备份开始菜单布局

4、打开资源管理器，输入下面的路径进入`%LocalAppData%\Microsoft\Windows\Shell` ，打开后界面如下图

![](https://pica.zhimg.com/v2-cfc1a1fede4d03190deee7a17c8e0080_1440w.jpg)

5、将[DefaultLayouts.xml](https://zhida.zhihu.com/search?content_id=168212587&content_type=Article&match_order=1&q=DefaultLayouts.xml&zd_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJ6aGlkYV9zZXJ2ZXIiLCJleHAiOjE3NDk3MTMyNTcsInEiOiJEZWZhdWx0TGF5b3V0cy54bWwiLCJ6aGlkYV9zb3VyY2UiOiJlbnRpdHkiLCJjb250ZW50X2lkIjoxNjgyMTI1ODcsImNvbnRlbnRfdHlwZSI6IkFydGljbGUiLCJtYXRjaF9vcmRlciI6MSwiemRfdG9rZW4iOm51bGx9.uW3u9LU4PlpY6gM1Y-jnz7X905wduSDpvYM0KLiHv3Y&zhida_source=entity)复制到你刚才保存注册表的文件夹  

![[Pasted image 20250610163902.1.png]]

### 2.3.2. 备份原用户浏览器配置

备份：`C:\Users\%username%\AppData\Local\Microsoft\Edge` 下的 `User Data` 文件到 `E:\维护相关\部长桌面配置` 中

![Pasted image 20250610165328.png](https://i0.hdslb.com/bfs/openplatform/214d52c7caecee62dc4e18c53b90df788a375de5.png)


### 2.3.3.  备份环境变量

#### （1）备份系统环境变量

1. win+r  输入 `regedit` 回车，在其地址栏输入 `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment ` 后回车

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/89dcfa45216f045cc36d5199605bae28.png)


2. 右键导出，命名为 `系统环境变量备份` 保存到   `E:\维护相关\部长桌面配置` 中

![image.png](https://i0.hdslb.com/bfs/openplatform/0cd4b8d8d99dec14e38426954f231f39b8330871.png)


#### （2）备份用户环境变量

1. win+r 输入`regedit` 回车，在其地址栏输入 `HKEY_CURRENT_USER\Environment` 后回车

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/ba163dfe3677239a37ba488020c0a3cb.png)  

2. 右键导出，命名为 `用户环境变量备份` 保存到  `E:\维护相关\部长桌面配置` 中

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/047da2ab71a6ed6b8ec90cd01e9ba1a2.png)


##  2.4. Aster 
### 2.4.1. 配置机位

### 2.4.2. 分配用户

## 2.5. 系统

### 2.5.1. 备份

### 2.5.2. 还原

# 3. 问题
## 3.1. 关机卡死

## 3.2. Aster 过期

1.3 屏幕会绿屏

系统环境变量的更新

[^1]: [win10如何显示我的电脑在桌面-百度经验](https://jingyan.baidu.com/article/d169e186b05932436611d8ad.html)