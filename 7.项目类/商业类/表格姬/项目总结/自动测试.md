ä½ æåˆ°äº†**è‡ªåŠ¨æµ‹è¯•åœ¨åæœŸåŠŸèƒ½å¤æ‚åâ€œè·Ÿä¸ä¸Šâ€çš„é—®é¢˜**ï¼Œè¿™æ˜¯å¾ˆå¤šå¼€å‘è€…ä»â€œå°é¡¹ç›®â€è½¬å‘â€œæˆç†Ÿç³»ç»Ÿâ€æ—¶éƒ½ä¼šé‡åˆ°çš„ä¸€ä¸ªä¸´ç•Œç‚¹ã€‚ä½ çš„ç›´è§‰å¾ˆå‡†ç¡®â€”â€”è¿™å…¶å®ä¸æ˜¯â€œä½ å†™çš„æµ‹è¯•ä¸å¤Ÿå¤šâ€ï¼Œè€Œæ˜¯ä½ è¿˜åœ¨ç”¨â€œå‚æ•°é©±åŠ¨æµ‹è¯•â€çš„æ–¹å¼æ¥åº”å¯¹**è¡Œä¸ºå¤æ‚ã€çŠ¶æ€ä¸°å¯Œã€ä¾èµ–å¤š**çš„ç³»ç»Ÿã€‚

---

## ğŸ“Œ ä½ ç°åœ¨é¢ä¸´çš„é—®é¢˜æœ¬è´¨ä¸Šæ˜¯ï¼š

- âœ… åŠŸèƒ½å˜å¾—**å¤šè·¯å¾„ã€å¤šçŠ¶æ€**ï¼ˆif/elseã€äº¤äº’åˆ†æ”¯ã€å¼‚å¸¸è·¯å¾„â€¦ï¼‰
    
- âœ… å‚æ•°ç»„åˆçˆ†ç‚¸ï¼Œæ— æ³•â€œç©·ä¸¾æµ‹è¯•â€
    
- âœ… ä¸€ä¸ªç®€å•è¾“å…¥å¯èƒ½å¯¼è‡´å¤šæ¨¡å—è”åŠ¨ï¼Œæµ‹è¯•éš¾ä»¥â€œå•ç‚¹å®šä½â€
    
- âœ… æµ‹è¯•ç»´æŠ¤å‹åŠ›ä¸Šå‡ â€”â€” æ”¹ä¸ªå‚æ•°å°±å¾—æ”¹ä¸€å †æµ‹è¯•ç”¨ä¾‹
    

---

## ğŸ§  è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ ¸å¿ƒæ€è·¯æ˜¯ï¼š

> **ä»â€œæ•°æ®é©±åŠ¨æµ‹è¯•â€ â†’ â€œè¡Œä¸ºé©±åŠ¨æµ‹è¯•â€+â€œæ¨¡å—éš”ç¦»æµ‹è¯•â€**  
> ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ éœ€è¦çš„ä¸æ˜¯â€œå†åŠ æµ‹è¯•å‚æ•°â€ï¼Œè€Œæ˜¯**æ”¹å˜æµ‹è¯•ç­–ç•¥**ã€‚

---

## âœ… è§£å†³æ–¹æ¡ˆæ¦‚è§ˆ

|æ–¹æ¡ˆ|ç›®æ ‡|å·¥å…·|
|---|---|---|
|1. å•å…ƒæµ‹è¯•æ‹†åˆ†|ç²¾å‡†æµ‹æ¯ä¸ªå‡½æ•° / æ¨¡å—|`pytest` / `unittest`|
|2. Mock / Stub|éš”ç¦»ä¾èµ–ï¼ˆå¦‚æ•°æ®åº“/IOï¼‰|`unittest.mock`|
|3. å‚æ•°åŒ–æµ‹è¯•|æ‰¹é‡æµ‹è¯•å˜å‚åœºæ™¯|`@pytest.mark.parametrize`|
|4. çŠ¶æ€æ¨¡å‹æµ‹è¯•ï¼ˆFSMï¼‰|ç”¨æœ‰é™çŠ¶æ€æœºå»ºæ¨¡ç³»ç»Ÿè¡Œä¸º|`pytest + hypothesis` / `transitions`|
|5. è¡Œä¸ºé©±åŠ¨æµ‹è¯•ï¼ˆBDDï¼‰|ç”¨è‡ªç„¶è¯­è¨€å®šä¹‰åŠŸèƒ½è¡Œä¸º|`behave`, `pytest-bdd`|
|6. å›å½’æµ‹è¯•|é˜²æ­¢â€œæ”¹ä¸€ä¸ªåŠŸèƒ½ï¼Œå¦ä¸€ä¸ªå´©äº†â€|ä¿å­˜æµ‹è¯•å¿«ç…§ + å˜æ›´å›æµ‹|
|7. è¦†ç›–ç‡æ£€æŸ¥|æ‰¾å‡ºæœªæµ‹ä»£ç è·¯å¾„|`coverage.py` + CI|

---

## ğŸ¯ ä¸¾ä¸ªä¾‹å­

ä½ åŸæ¥å¯èƒ½è¿™æ ·å†™æµ‹è¯•ï¼š

```python
def test_login_success():
    assert login("user", "1234") == True
```

ä½†å¦‚æœ `login()` æ¶‰åŠï¼š

- ç½‘ç»œè¯·æ±‚
    
- å¯†ç åŠ å¯†
    
- ç”¨æˆ·æƒé™æ£€æŸ¥
    
- ç™»å½•å¤±è´¥åè¦è®°å½•æ—¥å¿—
    

é‚£è¿™ç§æµ‹è¯•å°±å¾ˆå®¹æ˜“â€œæ©ç›–çœŸå®é—®é¢˜â€ï¼Œäºæ˜¯æˆ‘ä»¬ï¼š

---

## ğŸ§± æ”¹è¿›æµ‹è¯•ç­–ç•¥ä¸€ï¼š**Mock å¤–éƒ¨ä¾èµ–**

```python
from unittest.mock import patch

@patch("auth.db_check_user")
@patch("auth.log_event")
def test_login_success(mock_log, mock_db):
    mock_db.return_value = True
    result = login("user", "1234")
    assert result == True
    mock_log.assert_called_once_with("login_success")
```

ğŸ” å¥½å¤„ï¼š

- ä¸ç”¨çœŸå®è¿æ¥æ•°æ®åº“
    
- å¯ä»¥åªæµ‹è¯•â€œç™»å½•é€»è¾‘â€æœ¬èº«
    

---

## ğŸ§± æ”¹è¿›æµ‹è¯•ç­–ç•¥äºŒï¼š**ç”¨çŠ¶æ€å›¾å»ºæ¨¡å¤æ‚é€»è¾‘**

å‡è®¾ä½ çš„ BCI æ§åˆ¶æ¨¡å—çŠ¶æ€å¦‚ä¸‹ï¼š

```
[Idle] --> [Collecting EEG] --> [Analyzing] --> [Command Issued] --> [Idle]
```

ä½ å¯ä»¥ç”¨ `transitions` åº“å»ºæ¨¡å‹å¹¶é…å¥—å†™æµ‹è¯•ï¼š

```python
from transitions import Machine

class BCI:
    states = ["idle", "collecting", "analyzing", "command"]
    def __init__(self):
        self.machine = Machine(model=self, states=BCI.states, initial="idle")
        self.machine.add_transition('start', 'idle', 'collecting')
        self.machine.add_transition('analyze', 'collecting', 'analyzing')
        self.machine.add_transition('issue', 'analyzing', 'command')
        self.machine.add_transition('reset', '*', 'idle')

# æµ‹è¯•è¡Œä¸ºé“¾æ¡
def test_bci_sequence():
    bci = BCI()
    bci.start()
    assert bci.state == 'collecting'
    bci.analyze()
    assert bci.state == 'analyzing'
```

ğŸ” ä½ ä¸æµ‹â€œå…·ä½“ä¿¡å·å€¼â€ï¼Œä½ æµ‹â€œæµç¨‹æ˜¯å¦èµ°å¯¹â€

---

## ğŸ§± æ”¹è¿›æµ‹è¯•ç­–ç•¥ä¸‰ï¼š**ä½¿ç”¨è¡Œä¸ºé©±åŠ¨æµ‹è¯•ï¼ˆBDDï¼‰**

ä½ å¯ä»¥ç”¨ Gherkin è¯­è¨€æè¿°è¡Œä¸ºï¼š

```gherkin
Feature: æœºæ¢°è‡‚å“åº”è„‘æ§å‘½ä»¤

  Scenario: ç”¨æˆ·ä¸“æ³¨æ—¶æœºæ¢°è‡‚æŠ¬èµ·
    Given ç”¨æˆ·ä½©æˆ´è„‘ç”µè®¾å¤‡
    When æ£€æµ‹åˆ°ä¸“æ³¨æ¨¡å¼ä¿¡å·
    Then æœºæ¢°è‡‚åº”è¯¥æŠ¬èµ·
```

ç„¶åå†™ Python è„šæœ¬æ¥ç»‘å®šè¿™ä¸ªè¡Œä¸ºï¼š

```python
@given("ç”¨æˆ·ä½©æˆ´è„‘ç”µè®¾å¤‡")
def step_impl(context):
    context.bci = BCI()

@when("æ£€æµ‹åˆ°ä¸“æ³¨æ¨¡å¼ä¿¡å·")
def step_impl(context):
    context.bci.receive_signal("focus")

@then("æœºæ¢°è‡‚åº”è¯¥æŠ¬èµ·")
def step_impl(context):
    assert context.bci.command == "raise_arm"
```

ğŸ” å¥½å¤„ï¼š

- ä»**äººçš„è¡Œä¸ºè§’åº¦å‡ºå‘è®¾è®¡æµ‹è¯•**
    
- æ›´è´´åˆå®é™…ä½¿ç”¨è·¯å¾„
    

---

## ğŸ“‹ å»ºè®®ï¼šç»™ä½ ä¸€ä¸ªæµ‹è¯•æ¡†æ¶æ¨¡æ¿ç»“æ„

```
tests/
â”œâ”€â”€ test_bci_core.py         # å•å…ƒæµ‹è¯•
â”œâ”€â”€ test_arm_control.py      # æ§åˆ¶æ¥å£æµ‹è¯•
â”œâ”€â”€ test_sequence.py         # çŠ¶æ€/æµç¨‹æµ‹è¯•
â”œâ”€â”€ test_integration.py      # å¤šæ¨¡å—é›†æˆæµ‹è¯•
â”œâ”€â”€ features/                # è¡Œä¸ºæµ‹è¯•ç›®å½•ï¼ˆBDDï¼‰
â”‚   â”œâ”€â”€ arm_control.feature
â”‚   â””â”€â”€ steps/
â”‚       â””â”€â”€ test_steps.py
```

é…åˆï¼š

```bash
pytest --cov=my_project
behave features/
```

---

## ğŸ”š æ€»ç»“ï¼šä½ éœ€è¦çš„ä¸æ˜¯â€œå†™æ›´å¤šæµ‹è¯•â€ï¼Œè€Œæ˜¯ï¼š

|åº”å¯¹æ–¹å¼|ä½¿ç”¨æ—¶æœº|
|---|---|
|æ‹†åˆ†æ¨¡å—å•æµ‹|å‡½æ•°å˜å¤æ‚ã€ä¾èµ–å¤šæ—¶|
|ä½¿ç”¨ mock|é¿å…å¤–éƒ¨ç¯å¢ƒå½±å“ï¼ˆDB/ç½‘ç»œï¼‰|
|åŠ çŠ¶æ€æœº/æµç¨‹æµ‹è¯•|æœ‰å¤šæ­¥éª¤æµç¨‹çš„æ¨¡å—ï¼ˆå¦‚ BCI æ§åˆ¶æµç¨‹ï¼‰|
|å¼•å…¥ BDD|æµ‹è¯•â€œç”¨æˆ·è¡Œä¸º â†’ é¢„æœŸç»“æœâ€é“¾æ¡|
|å…³æ³¨å›å½’|æ”¹åŠ¨ä»£ç ååŸåŠŸèƒ½æ˜¯å¦ä¿æŒæ­£å¸¸|
|å®šæœŸæ¸…ç†æµ‹è¯•|é˜²æ­¢æµ‹è¯•å†—ä½™ã€åºŸå¼ƒã€å†²çª|

---

å¦‚æœä½ æ„¿æ„ï¼Œæˆ‘å¯ä»¥ï¼š

- ğŸ› ï¸ å¸®ä½ å†™ä¸€ä»½é€‚åˆä½ å½“å‰é¡¹ç›®çš„ `pytest` + `mock` æ¨¡æ¿
    
- ğŸ“„ ç”Ÿæˆä¸€ä¸ªæµ‹è¯•è®¡åˆ’æ–‡æ¡£ï¼ˆå†™å“ªäº›æ¨¡å—ã€è¦†ç›–å“ªäº›è¡Œä¸ºï¼‰
    
- ğŸ” å¸®ä½ è®¾ç½® GitHub Actions è‡ªåŠ¨è¿è¡Œæµ‹è¯•
    

ä½ ç°åœ¨å“ªä¸ªæ¨¡å—çš„æµ‹è¯•æœ€éš¾å†™ï¼Ÿæˆ‘ä»¬å¯ä»¥ä»é‚£ä¸€å—å¼€å§‹ä¼˜åŒ–ã€‚